<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diego Pedraza Barajas 2105940X Abigail Sampedro Gutierrez 2105944A Ana Berenice Garcia Hernandez 2105931K">

<title>Probabilidad Gaussiana multivariada</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Probabilidad Gaussiana multivariada</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Diego Pedraza Barajas 2105940X<br>
Abigail Sampedro Gutierrez 2105944A<br>
Ana Berenice Garcia Hernandez 2105931K </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Universidad Michoacana de San Nicolas de Hidalgo</p>
<p>Lic. En Actuaria y Ciencia de Datos</p>
<p><img src="logo.png" class="img-fluid" width="200"> <img src="actuaria.jpg" class="img-fluid" width="300"></p>
<p>Probabilidad Gaussiana multivariada: Forma de cálculo, exposición de sus parámetros y el concepto de elipsidad relacionado con la correlación Pearson.</p>
<p>Administracción de riesgos</p>
<p>2105940x@umich.mx</p>
<p>2105944a@umich.mx</p>
<p>2105931K@umich.mx</p>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La distribución normal univariada (<span class="math inline">\(N(\mu, \sigma^2)\)</span>) es una distribución de probabilidad continua que se caracteriza principalmente por su forma de campana, esta se define usando principalmente dos parámetros:</p>
<ol type="1">
<li><span class="math inline">\(\mu\)</span> (mu): La media o valor esperado de la distribución.</li>
<li><span class="math inline">\(\sigma\)</span> (sigma): La desviación típica, que mide la dispersión de la distribución.</li>
</ol>
<p>La función de densidad de probabilidad (PDF) se da por:</p>
<p><span class="math display">\[f(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}\]</span></p>
<p>Donde:</p>
<ul>
<li><strong>X</strong>: es la variable</li>
<li><strong>e</strong>: es el número de Euler</li>
</ul>
<p>La naturaleza de las distribuciones gaussianas se puede explicar por el teorema del límite central, el cual establece que la distribución de las medias muestrales se aproxima a una distribución normal a medida que la muestra aumenta (<span class="math inline">\(n \ge 30\)</span>) incluso si la población está sesgada.</p>
<p>Aunque dentro de las distribuciones gaussianas hay un caso especial, la distribución gaussiana estándar, o distribución normal estándar, básicamente es:</p>
<ol type="1">
<li>La media (<span class="math inline">\(\mu\)</span>) es exactamente 0.</li>
<li>La desviación típica (<span class="math inline">\(\sigma\)</span>) es exactamente 1.</li>
</ol>
<p><span class="math display">\[f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}\]</span></p>
<p>En el análisis de riesgos, las variables aisladas son insuficientes, ya que existe una interconexión entre factores como precios de los activos, tasas de interés, tipos de cambio y precios de materias primas, etc., estos generan dependencias complejas, por lo que se vuelve imperativo evaluar de manera completa las variables implicadas.</p>
<p>Para comprender mejor esto, se debe conocer el concepto de vector aleatorio, el cual permite analizar un conjunto de variables aleatorias de manera simultánea, este vector puede representar rendimientos diarios de los activos en una cartera de inversión, lo cual resulta útil en un contexto financiero.</p>
<p>La distribución normal multivariada es la generalización de la distribución normal en un plano multidimensional, analizando la forma, orientación y densidad del conjunto de puntos en un espacio de p dimensiones, captando la interrelación entre cada variable, cada conjunto de variables aleatorias multivariadas se caracteriza por un vector de medias y una matriz de covarianza, las cuales describen la tendencia central y la relación entre las variables. <span class="math inline">\(X \sim N_p(\mu, \Sigma)\)</span>, donde p es el número de variables, <span class="math inline">\(\mu\)</span> es el vector de medias y <span class="math inline">\(\Sigma\)</span> es la matriz de varianzas-covarianzas.</p>
</section>
<section id="el-vector-de-medias-mu-y-la-matriz-de-covarianzas-sigma" class="level2">
<h2 class="anchored" data-anchor-id="el-vector-de-medias-mu-y-la-matriz-de-covarianzas-sigma">El vector de medias (<span class="math inline">\(\mu\)</span>) y la Matriz de Covarianzas (<span class="math inline">\(\Sigma\)</span>)</h2>
<p>El vector de medias (<span class="math inline">\(\mu\)</span>) se define como el vector de esperanzas matemáticas de cada componente del vector aleatorio X:</p>
<p><span class="math display">\[\mu=E[X]=\begin{pmatrix}E[X_{1}]\\ E[X_{2}]\\ \vdots\\ E[X_{p}]\end{pmatrix}=\begin{pmatrix}\mu_{1}\\ \mu_{2}\\ \vdots\\ \mu_{p}\end{pmatrix}\]</span></p>
<p>(<span class="math inline">\(\mu\)</span>) Corresponde al vector de los rendimientos esperados para cada uno de los p activos que componen la cartera.</p>
<p>Por otro lado, la matriz de varianzas-covarianzas, <span class="math inline">\(\Sigma\)</span>, define su forma, tamaño y orientación: <span class="math inline">\(\Sigma=\Sigma^{T}\)</span></p>
<p><strong>Diagonal principal</strong>: <span class="math inline">\(\sigma_{ii}=\sigma_{i}^2\)</span> son las varianzas de cada variable aleatoria individual <span class="math inline">\(X_i\)</span>, miden la dispersión de cada activo individualmente, sin considerarse los demás, es decir, la covarianza entre una variable y ella misma.</p>
<p><strong>Fuera de la diagonal</strong>: <span class="math inline">\(\sigma_{ij}\)</span> para <span class="math inline">\(i \ne j\)</span> son las covarianzas entre los pares de variables <span class="math inline">\(X_i\)</span> y <span class="math inline">\(X_j\)</span>. <span class="math inline">\(Cov(X_i, X_j)\)</span> mide la dirección de la relación lineal entre dos activos.</p>
<p>La matriz tiene dos propiedades matemáticas:</p>
<ol type="1">
<li><strong>Simetría</strong>: esto significa que <span class="math inline">\(\Sigma=\Sigma^{T}\)</span> esto pasa porque la covarianza entre <span class="math inline">\(X_i\)</span> y <span class="math inline">\(X_j\)</span> es la misma que entre <span class="math inline">\(X_j\)</span> y <span class="math inline">\(X_i\)</span> (<span class="math inline">\(\sigma_{ij}=\sigma_{ji}\)</span>).</li>
<li><strong>Semidefinición positiva</strong>: para cualquier vector no nulo <span class="math inline">\(v\)</span>, se cumple que <span class="math inline">\(v^{T}\Sigma v \ge 0\)</span> nos indica que la varianza de cualquier combinación lineal nunca puede ser negativa.</li>
</ol>
<p>Si la matriz es definida positiva, entonces es invertible.</p>
</section>
<section id="covarianza-y-correlación" class="level2">
<h2 class="anchored" data-anchor-id="covarianza-y-correlación">Covarianza y correlación</h2>
<p>La covarianza es una medida cuantitativa en que la desviación de una variable X de su media está relacionada con la desviación de otra variable Y de su media, midiendo la variabilidad conjunta de dos variables aleatorias.</p>
<p>La covarianza se utiliza para medir la relación lineal entre dos variables aleatorias, pero no es una medida estandarizada y su magnitud depende de la escala de las variables, por lo que se vuelve un tanto complicada su interpretación.</p>
<p>Una covarianza positiva indica que los rendimientos de los dos activos tienden a moverse en la misma dirección, por lo que comparten un comportamiento similar, mientras que una covarianza negativa nos dice que tienden a moverse en direcciones contrarias, lo que implica que si una variable aumenta, la otra disminuye, finalmente, la correlación cero o nula se produce cuando no hay relación lineal entre las variables, expresándose como un valor cercano a 0, esto nos indica que no hay relación entre las variables.</p>
<p>La correlación se calcula utilizando un método conocido como Correlación producto-momento de Pearson o como Coeficiente de correlación, este coeficiente varía entre -1 y 1. Un valor cercano a 1 índica correlación positiva fuerte, mientras que un valor cercano a -1 índica correlación negativa fuerte, un valor cercano a 0 indica correlación nula entra las variables.</p>
<p>Finalmente, la covarianza indica el grado en que dos variables varían entre sí, mientras que la correlación determina la fuerza y dirección de esta relación.</p>
<section id="coeficiente-de-correlación-de-pearson" class="level3">
<h3 class="anchored" data-anchor-id="coeficiente-de-correlación-de-pearson">Coeficiente de correlación de Pearson</h3>
<p>Este coeficiente es denotado por <span class="math inline">\(\rho\)</span>, se calcula como:</p>
<p><span class="math display">\[\rho_{ij}=\frac{\sigma_{ij}}{\sigma_{i}\sigma_{j}}\]</span></p>
<p>El valor <span class="math inline">\(\rho_{ij}\)</span> está acotado por -1 y 1, lo que nos da una medida estandarizada y de fácil interpretación.</p>
<p>Sabiendo todo esto, tenemos que a partir de la matriz de covarianzas <span class="math inline">\(\Sigma\)</span>, se puede derivar la matriz de correlación R, la cual tiene unos en su diagonal principal y los coeficientes de correlación <span class="math inline">\(\rho_{ij}\)</span> en los elementos fuera de la diagonal.</p>
</section>
</section>
<section id="fórmula-de-la-densidad-gaussiana-multivariada" class="level2">
<h2 class="anchored" data-anchor-id="fórmula-de-la-densidad-gaussiana-multivariada">Fórmula de la Densidad Gaussiana Multivariada</h2>
<p>La función de densidad de probabilidad (PDF) de la distribución normal multivariada asigna una densidad de probabilidad a cada punto x en el espacio p- dimensional.</p>
<p>Para un vector aleatorio <span class="math inline">\(X \sim N_p(\mu,\Sigma)\)</span> con una matriz invertible, su fórmula es:</p>
<p><span class="math display">\[f(x|\mu,\Sigma)=\frac{1}{\sqrt{(2\pi)^{p}|\Sigma|}}exp\left(-\frac{1}{2}(x-\mu)^{T}\Sigma^{-1}(x-\mu)\right)\]</span></p>
<p>El propósito del término de la normalización es asegurarse de que el volumen total bajo la hipersuperficie de densidad sea igual a 1. El determinante de la matriz de covarianzas o varianza generalizada, mide el volumen del hiperparalelepípedo formados por los vectores columna de la matriz. Un valor grande nos dice que hay una gran dispersión general de los datos, mientras que un determinante cercano a 0 nos dice que las variables son aleatoriamente colineales, lo que nos indica que los datos pueden chocar en un subespacio menor.</p>
<p>El exponente y distancia de Mahalanobis con fórmula <span class="math inline">\((x-\mu)^{T}\Sigma^{-1}(x-\mu)\)</span>, es quien nos define la forma de la campana gaussiana en más de una dimensión, este término se conoce formalmente como distancia de Mahalanobis al cuadrado, este es una medida de distancia estadística que generaliza el z-score (mide distancia en unidades de desviación estándar) a un entorno de múltiples variables, teniendo en cuenta la estructura de covarianza de los datos, midiendo la distancia de un punto x al centro de masa <span class="math inline">\(\mu\)</span> en unidades de desviación estándar correlacionadas.</p>
<p>Por lo tanto, la densidad de probabilidad es una función que disminuye exponencialmente a medida que aumenta la distancia de Mahalanobis al cuadrado desde el centro, por lo que todos los puntos que se encuentran a la misma distancia de Mahalanobis del centro tienen la misma densidad de probabilidad.</p>
<p>Para visualizar la función de densidad de más de dos dimensiones, se trazan sus curvas de nivel o contornos de hipodensidad, lo que se reflejaría como cortar la superficie en planos horizontales paralelos a la base, su fórmula es:</p>
<p><span class="math display">\[(x - \mu)^T \Sigma^{-1} (x - \mu) = c^2\]</span></p>
<p>La forma y orientación de estas elipses de contorno se determinan por la matriz de covarianzas y por el coeficiente de correlación de Pearson.</p>
<ol type="1">
<li><p><strong>Correlación 0 (<span class="math inline">\(\rho=0\)</span>)</strong> Cuando no hay correlación entre dos variables, la matriz de covarianzas es diagonal, por lo que los ejes de las elipses estarán alineados con los ejes de coordenadas <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>, mientras que su longitud va a depender de las varianzas individuales. Si las covarianzas son iguales, la matriz de covarianzas se convierte en un múltiplo de la matriz identidad, por lo que las elipses ahora serán círculos, por lo que la dispersión será isótropa e igual en todas las direcciones.</p></li>
<li><p><strong>Correlación positiva (<span class="math inline">\(0 &lt; \rho &lt; 1\)</span>)</strong> Las elipses se alargan y se inclinan con una pendiente positiva, habrá valores elevados de <span class="math inline">\(X_1\)</span> y de <span class="math inline">\(X_2\)</span>. En el límite teórico de <span class="math inline">\(\rho=1\)</span>, la distribución colapsaría sobre una línea recta y la matriz sería singular.</p></li>
<li><p><strong>Correlación negativa (<span class="math inline">\(-1 &lt; \rho &lt; 0\)</span>)</strong> Hace que las elipses se alarguen y se inclinen con pendiente negativa, asociado a la tendencia de que valores altos de una variable se asocien con valores bajos de la otra. Si <span class="math inline">\(\rho\)</span> se acerca a -1 las elipses se vuelven más delgadas y alargadas en esa dirección.</p></li>
</ol>
</section>
<section id="eigenvectores-y-eigenvalores" class="level2">
<h2 class="anchored" data-anchor-id="eigenvectores-y-eigenvalores">Eigenvectores y Eigenvalores</h2>
<p>Los eigenvectores de la matriz de covarianzas <span class="math inline">\(\Sigma\)</span> definen las direcciones de los ejes principales de las elipses de isodensidad, representando las direcciones de máxima y mínima varianza en los datos. Este debe ser un vector no nulo que cuando se le aplica su transformación, solo cambia en su magnitud o sentido, pero no en su dirección.</p>
<p>Los eigenvalores son proporcionales al cuadrado de las longitudes de estos ejes principales. Un eigenvalor grande indica una gran dispersión a lo largo de la dirección de su eigenvector asociado, mientras que un eigenvalor pequeño indica poca dispersión. Este valor es el escalar asociado al eigenvector y representa el factor por el cual este es escalado o “estirado” cuando se le aplica la transformación lineal.</p>
<ul>
<li>Si <span class="math inline">\(\lambda &gt; 1\)</span>, el eigenvector se alarga.</li>
<li>Si <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span>, el eigenvector se acorta.</li>
<li>Si <span class="math inline">\(\lambda &lt; 0\)</span>, el eigenvector se invierte y se escala.</li>
<li>Si <span class="math inline">\(\lambda = 1\)</span>, el eigenvector no cambia de magnitud.</li>
<li>Si <span class="math inline">\(\lambda = 0\)</span>, el eigenvector se mapea al vector cero.</li>
</ul>
</section>
<section id="heavy-tails" class="level2">
<h2 class="anchored" data-anchor-id="heavy-tails">Heavy Tails</h2>
<p>El supuesto de normalidad en modelos financieros tradicionales, son un supuesto poco probable, generalmente las distribuciones de rendimientos reales exhiben leptocurtosis (exceso de curtosis, lo que significa que los datos están muy concentrados alrededor de la media, dando paso a un pico más alto y estrecho en comparación a una distribución normal, asimismo tienen colas más largas, lo que aumenta la probabilidad de encontrar valores extremos o fuera de lo común, ya sean positivos o negativos en comparación a lo que se esperaría en una distribución normal de igual forma).</p>
<p>Este fenómeno de colas pesadas implica que los eventos extremos son mucho más probables de lo que el modelo gaussiano propone, por lo que algunos modelos como el VaR subestiman el tail risk, que es el riesgo de eventos catastróficos, que son los que más se deben cuantificar, un ejemplo de ellos fue la crisis financiera del 2008, la cual sucedió por confiar en modelos que no visualizaban adecuadamente la probabilidad de estos eventos extremos.</p>
</section>
<section id="alternativas" class="level2">
<h2 class="anchored" data-anchor-id="alternativas">Alternativas</h2>
<p>Se han desarrollado modelos que buscan calcular mejor las características de los datos financieros reales, una de las más populares es la distribución t-Student multivariada, la cual es una generalización de la normal, pero incluye un parámetro adicional: los grados de libertad (v), este parámetro controla el grosor de las colas de la distribución, cuando v disminuye, las colas se vuelven más pesadas, teniendo una mayor probabilidad a los eventos extremos, pero cuando v tiende a infinito, la distribución t-Student converge a una distribución normal, la cual la hace un caso límite.</p>
</section>
<section id="bisualizacion-geometrica-bivariada" class="level2">
<h2 class="anchored" data-anchor-id="bisualizacion-geometrica-bivariada">Bisualizacion geometrica bivariada</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clusterGeneration)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sigma_result <span class="ot">&lt;-</span> <span class="fu">genPositiveDefMat</span>(<span class="at">dim =</span> <span class="dv">2</span>, <span class="at">covMethod =</span> <span class="st">"unifcor"</span>, <span class="at">rangeVar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> sigma_result<span class="sc">$</span>Sigma</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">1500</span>, <span class="at">mean =</span> mu, <span class="at">sigma =</span> sigma)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>datos_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(datos)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_df, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgray"</span>) <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="fu">aes</span>(<span class="at">color =</span> ..level..), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución Normal Multivariada Aleatoria"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Centro en ("</span>, <span class="fu">round</span>(mu[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">", "</span>, <span class="fu">round</span>(mu[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">")"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">" | Correlación: "</span>, <span class="fu">round</span>(<span class="fu">cov2cor</span>(sigma)[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variable X"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Variable Y"</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dist-multivariada-aleatoria" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dist-multivariada-aleatoria-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-dist-multivariada-aleatoria-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dist-multivariada-aleatoria-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Distribución Normal Multivariada con Parámetros Aleatorios
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusión" class="level2">
<h2 class="anchored" data-anchor-id="conclusión">Conclusión</h2>
<p>La distribución gaussiana multivariada es básicamente una extensión de la curva de campana a varias dimensiones. En lugar de usar una media y una varianza, usamos un vector de medias (<span class="math inline">\(\mu\)</span>) y una matriz de covarianzas (<span class="math inline">\(\Sigma\)</span>).</p>
<p>El vector <span class="math inline">\(\mu\)</span>: nos dice dónde está el centro o pico de la distribución en ese espacio multidimensional.</p>
<p>La matriz <span class="math inline">\(\Sigma\)</span> define la forma, el tamaño y la orientación de la distribución. Aquí es donde se codifica cómo se relacionan las diferentes dimensiones o variables.</p>
<p>Hay un vínculo directo y esencial entre la matriz <span class="math inline">\(\Sigma\)</span> y la geometría de la distribución. La estructura de dependencia que <span class="math inline">\(\Sigma\)</span> captura, especialmente la correlación, se refleja en las formas de los elipsoides de isodensidad (que son como los contornos tridimensionales de la distribución).</p>
<ul>
<li>Si las variables no están correlacionadas, estos elipsoides se alinean perfectamente con los ejes.</li>
<li>Si hay correlación (positiva o negativa), la distribución se “inclina” o rota en el espacio en función a su signo.</li>
</ul>
<p>Lo que realmente une la fórmula matemática de la probabilidad con esta forma geométrica es la distancia de Mahalanobis. Esta medida asegura que cualquier punto que se encuentre en el mismo elipsoide de contorno (es decir, a la misma distancia de Mahalanobis del centro <span class="math inline">\(\mu\)</span>) tendrá la misma densidad de probabilidad.</p>
<p>A pesar de las limitaciones, especialmente prediciendo las heavy tails de las distribuciones, la distribución normal multivariada sigue siento una parte fundamental en la teoría financiera y para la gestión de riesgos; sin embargo, en la actualidad ya solo se considera como un punto de partida o como modelo de referencia, con el cual se comparan algunos modelos más sofisticados, el analista ya entra en acción al momento de comprender y analizar los supuestos e identificar las condiciones del mercado en las que esos supuestos puedan fallar, actualmente la distribución t-Student es una herramienta mucho más completa para la estimación de estos parámetros y predicciones, por lo que también es de las más usadas en el presente.</p>
</section>
<section id="referencias" class="level2">
<h2 class="anchored" data-anchor-id="referencias">Referencias</h2>
<p>National Library of Medicine. (2023). <em>Explainable AI models for healthcare applications</em>. PubMed Central. Recuperado el 1 de octubre de 2025, de <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10453792" target="_blank">LINK</a></p>
<p>Stanford University. (s. f.). <em>Multivariate Gaussians</em>. Stanford CS229. Recuperado el 1 de octubre de 2025, de <a href="https://cs229.stanford.edu/section/gaussians.pdf" target="_blank">LINK</a></p>
<p>Peng, H. (s. f.). <em>Lecture note 3: Multivariate normal distribution</em>. Hong Kong Baptist University. Recuperado el 1 de octubre de 2025, de <a href="https://www.math.hkbu.edu.hk/~hpeng/Math3806/Lecture_note3.pdf" target="_blank">LINK</a></p>
<p>Ayala, J. (2018). <em>Distribución Normal Multivariada</em>. RPubs. Recuperado el 1 de octubre de 2025, de <a href="https://rpubs.com/JairoAyala/DNM" target="_blank">LINK</a></p>
<p>Scribd. (s. f.). <em>Gaussiana multivariable</em>. Recuperado el 1 de octubre de 2025, de <a href="https://es.scribd.com/document/385777673/Gaussiana-multivariable-pdf" target="_blank">LINK</a></p>
<p>Baíllo, A. (s. f.). <em>Normal multivariante</em>. Universidad Autónoma de Madrid. Recuperado el 1 de octubre de 2025, de <a href="https://verso.mat.uam.es/~amparo.baillo/MatEstII/EII%201%20Normal%20multivariante.pdf" target="_blank">LINK</a></p>
<p>FasterCapital. (s. f.). <em>Covarianza: comprensión de la covarianza a través del coeficiente de Pearson</em>. Recuperado el 1 de octubre de 2025, de <a href="https://fastercapital.com/es/contenido/Covarianza--comprension-de-la-covarianza-a-traves-del-coeficiente-de-Pearson.html" target="_blank">LINK</a></p>
<p>Denapo, P. (2021). <em>Clase 13: Normal multivariada</em>. Universidad de Buenos Aires. Recuperado el 1 de octubre de 2025, de <a href="https://mate.dm.uba.ar/~pdenapo/apuntes-proba/2021/clase-13-normal_multivariada.pdf" target="_blank">LINK</a></p>
<p>DataCamp. (s. f.). <em>Distribución gaussiana</em>. DataCamp Tutorial. Recuperado el 1 de octubre de 2025, de <a href="https://www.datacamp.com/es/tutorial/gaussian-distribution" target="_blank">LINK</a></p>
<p>Ayala, J. (2018). <em>Índice de Masa Corporal con distribución normal</em>. RPubs. Recuperado el 1 de octubre de 2025, de <a href="https://rpubs.com/JairoAyala/IMC" target="_blank">LINK</a></p>
<p>Wikipedia. (s. f.). <em>Distribución normal multivariada</em>. En <em>Wikipedia</em>. Recuperado el 1 de octubre de 2025, de <a href="https://es.wikipedia.org/wiki/Distribución_normal_multivariada" target="_blank">LINK</a></p>
<p>Wikipedia. (s. f.). <em>Multivariate normal distribution</em>. En <em>Wikipedia</em>. Recuperado el 1 de octubre de 2025, de <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution" target="_blank">LINK</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>